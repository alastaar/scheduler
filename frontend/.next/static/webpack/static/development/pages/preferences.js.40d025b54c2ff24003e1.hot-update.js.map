{"version":3,"file":"static/webpack/static/development/pages/preferences.js.40d025b54c2ff24003e1.hot-update.js","sources":["webpack:///./components/EmailPreferences.js"],"sourcesContent":["import { Query, Mutation } from 'react-apollo';\nimport Error from './ErrorMessage';\nimport gql from 'graphql-tag';\nimport Table from './styles/Table';\nimport SickButton from './styles/SickButton';\nimport PropTypes from 'prop-types';\nimport User, { CURRENT_USER_QUERY } from './User';\n\nconst UPDATE_PREFERENCES_MUTATION = gql`\n  mutation updatePreferences($emailPreference: [EmailPreference], $userId: ID!) {\n    updatePreferences(emailPreference: $emailPreference, userId: $userId) {\n      id\n      emailPreference\n      name\n      lastName\n      email\n    }\n  }\n`;\n\nconst possiblePreferences = [\n  'REQUESTCREATED',\n  'REQUESTAPPROVED',\n  'REQUESTCONFIRMED',\n  'REQUESTREJECTED',\n  'REQUESTDELETED',\n  'APPOINTMENTTOMORROW',\n  'UPDATEDSTRIPEACCOUNT',\n  'UPDATEDCARD',\n];\n\nconst SickNastyButton = styled.div`\n  height: 20px;\n  padding-left: 5px;\n  padding-right: 5px;\n  padding-top: 2px;\n  padding-bottom: 2px;\n`;\n\n\n\nconst EmailPreferences = props => (\n  <User>\n      {({ data: { me } }) => (\n        <Query query={CURRENT_USER_QUERY}>\n          {({ data, loading, error }) => (\n            <div>\n              <Error error={error} />\n              <div>\n                <h2>Manage Email Preferences</h2>\n                <Table>\n                      <p>Name</p>\n                      <p>Email</p>\n                      <p>Email when someone requests you</p>\n                      {possiblePreferences.map(preference => <p key={preference}>{preference}</p>)}\n                </Table>\n                <UserPreferences user={me} key={me.id} />\n              </div>\n            </div>\n          )}\n        </Query>\n      )}\n  </User>\n);\n\nclass UserPreferences extends React.Component {\n  static propTypes = {\n    user: PropTypes.shape({\n      name: PropTypes.string,\n      email: PropTypes.string,\n      id: PropTypes.string,\n      emailPreference: PropTypes.array,\n    }).isRequired,\n  };\n  state = {\n    preferences: this.props.user.emailPreference,\n  };\n  handlePreferenceChange = (e) => {\n    const checkbox = e.target;\n    // take a copy of the current permissions\n    let updatedPreferences = [...this.state.preferences];\n    // figure out if we need to remove or add this permission\n    if (checkbox.checked) {\n      // add it in!\n      updatedPreferences.push(checkbox.value);\n    } else {\n      updatedPreferences = updatedPreferences.filter(preference => preference !== checkbox.value);\n    }\n    this.setState({ preferences: updatedPreferences });\n  };\n  render() {\n    const user = this.props.user;\n    return (\n      <Mutation\n        mutation={UPDATE_PREFERENCES_MUTATION}\n        variables={{\n          preferences: this.state.preferences,\n          userId: this.props.user.id,\n        }}\n      >\n        {(updatePreferences, { loading, error }) => (\n          <>\n            <Table>\n              {error && <tr><td colspan=\"8\"><Error error={error} /></td></tr>}\n                <p>{user.name} { user.lastName }</p>\n                <p>{user.email}</p>\n                {possiblePreferences.map(preference => (\n                  <p key={preference}>\n                    <label htmlFor={`${user.id}-preference-${preference}`}>\n                      <input\n                        id={`${user.id}-preference-${preference}`}\n                        type=\"checkbox\"\n                        checked={this.state.preferences.includes(preference)}\n                        value={preference}\n                        onChange={this.handlePreferenceChange}\n                      />\n                    </label>\n                  </p>\n                ))}\n            </Table>\n            <SickButton type=\"button\" disabled={loading} onClick={updatePreferences}>\n              Updat{loading ? 'ing' : 'e'}\n            </SickButton>\n          </>\n        )}\n      </Mutation>\n    );\n  }\n}\n\nexport { UPDATE_PREFERENCES_MUTATION };\nexport default EmailPreferences;\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAYA;AAWA;AAAA;AAAA;AAAA;AACA;AASA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAXA;AAFA;AAFA;AACA;AAuBA;;;;;;;;;;;;;;;;;;AASA;AACA;AADA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AACA;;;;;;AAAA;AAAA;AACA;AAAA;AACA;AAEA;AACA;AACA;AACA;AAFA;AAFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAOA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AALA;AAAA;AAAA;AAAA;AAAA;AAAA;AAHA;AAcA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AApBA;AA2BA;;;;AA9DA;AACA;AADA;AAEA;AACA;AACA;AACA;AACA;AAJA;AADA;AACA;AA+DA;AACA;;;;A","sourceRoot":""}